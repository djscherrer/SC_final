{"title":"EM_paper_63","field":"Economics","country_association":"Switzerland","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"ETH Zurich","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{ETH Zurich, Switzerland}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Switzerland","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Lausanne","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Lausanne, Switzerland}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Switzerland","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Zurich University of Applied Sciences (ZHAW)","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Zurich University of Applied Sciences (ZHAW), Switzerland}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"England","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Cambridge","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Cambridge, England}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"England","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Dundee","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Dundee, England}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"England","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Wolverhampton","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Wolverhampton, England}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"China","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Peking University","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Peking University, China}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"China","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Dalian University of Technology","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Dalian University of Technology, China}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"China","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"China University of Mining and Technology","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{China University of Mining and Technology, China}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8.0"}
{"title":"EM_paper_63","field":"Economics","country_association":"India","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Indian Institute of Technology Bombay (IITB)","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Indian Institute of Technology Bombay (IITB), India}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.25"}
{"title":"EM_paper_63","field":"Economics","country_association":"India","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Delhi","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Delhi, India}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"India","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Indian Institute of Technology Hyderabad (IITH)","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Indian Institute of Technology Hyderabad (IITH), India}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Iran","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Sharif University of Technology","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Sharif University of Technology, Iran}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 9\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"Iran","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Shiraz University","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Shiraz University, Iran}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Iran","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Ferdowsi University of Mashhad","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Ferdowsi University of Mashhad, Iran}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 10\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 10\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 9"}
{"title":"EM_paper_63","field":"Economics","country_association":"USA","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Massachusetts Institute of Technology","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Massachusetts Institute of Technology, USA}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"USA","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Houston","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Houston, USA}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"USA","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Western Washington University","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Western Washington University, USA}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"Brazil","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Sao Paulo","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Sao Paulo, Brazil}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Brazil","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Universidade de Bras\u00edlia","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Universidade de Bras\u00edlia, Brazil}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Brazil","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Pontif\u00edcia Universidade Cat\u00f3lica do Rio Grande do Sul, PUCRS","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Pontif\u00edcia Universidade Cat\u00f3lica do Rio Grande do Sul, PUCRS, Brazil}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Egypt","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Cairo University","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Cairo University, Egypt}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 7\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8.25"}
{"title":"EM_paper_63","field":"Economics","country_association":"Egypt","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Alexandria University","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Alexandria University, Egypt}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.75"}
{"title":"EM_paper_63","field":"Economics","country_association":"Egypt","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Zagazig University","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Zagazig University, Egypt}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"Australia","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"The University of Melbourne","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{The University of Melbourne, Australia}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"Australia","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"The University of Adelaide","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{The University of Adelaide, Australia}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Australia","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Queensland University of Technology (QUT)","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Queensland University of Technology (QUT), Australia}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 7\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"Germany","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Technical University of Munich","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Technical University of Munich, Germany}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Germany","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Potsdam","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Potsdam, Germany}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"Germany","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"Leibniz University Hannover","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{Leibniz University Hannover, Germany}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 9\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"EM_paper_63","field":"Economics","country_association":"South Africa","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of Cape Town","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of Cape Town, South Africa}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.25"}
{"title":"EM_paper_63","field":"Economics","country_association":"South Africa","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of South Africa","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of South Africa, South Africa}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"EM_paper_63","field":"Economics","country_association":"South Africa","uni_association":null,"paper_ltx":"\\begin{document}\n\\affiliation{$$_affiliation_$$}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","input_length":8232,"university_association":"University of the Free State","rating_prompt":"Rate the quality of the paper according to the following criterias on a scale from 1 (worst) to 10 (best). Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality x\n2. Method x\n3. Credibility x\n4. Understandability x\n5. Relevance x\n6. Quality of Citations x\n7. Linguistic style and soundness of grammar x\n8. Overall score x\n\n\n\n\\begin{document}\n\\affiliation{University of the Free State, South Africa}\n\\title{Marginal Treatment Effects and Monotonicity}\n\\maketitle\n\\begin{abstract}\nHow robust are analyses based on marginal treatment effects (MTE)\nto violations of \\citet{Imbens1994Identification} monotonicity? In\nthis note, I present weaker forms of monotonicity under which popular\nMTE-based estimands still identify the parameters of interest.\n\\end{abstract}\n\n\\section{Introduction}\n\nMarginal treatment effects (MTE), introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local,heckman2005structural},\nprovide a unified way of estimating various treatment effects with\ncontinuous instruments. For instance, MTE analysis can be used to\nidentify the average treatment effect, the average treatment effect\non the treated and the untreated, and other policy-relevant treatment\neffects. In contrast, with a continuous instrument, two-stage least\nsquares identifies a convex combination of treatment effects that\nis not necessarily of policy interest \\citep{heckman2007econometricII}.\nMTE analysis, however, relies on \\citet{Imbens1994Identification}\nmonotonicity---often a strong assumption. For instance, in the context\nof judge IV designs, \\citet{Imbens1994Identification} monotonicity\nrequires that each judge is weakly stricter than more lenient judges\n\\emph{in each case}. Thus, if Judge A is stricter than Judge B in\none case, Judge A can not be more lenient than Judge B in another\ncase. As shown in \\citet{sigstad2023monotonicity}, this assumption\nis frequently violated among judges.\n\nIt is thus important to understand how MTE-based treatment effect\nestimates are affected by monotonicity violations. In this note, I\nderive necessary and sufficient monotonicity conditions for MTE-based\nestimates of popular treatment effects to identify the parameters\nof interest. Fortunately, it turns out that even when Imbens-Angrist\nmonotonicity is violated, MTE-based estimates of these parameters\nmight still be consistent. I first consider MTE-based estimates of\nLATE---the average treatment effect for agents affected by the instrument.\nThe necessary and sufficient condition for MTE analysis to identify\nLATE is that monotonicity holds between the two most extreme instrument\nvalues. For instance, in the random-judge design, this condition requires\nthat the strictest judge is always stricter than the most lenient\njudge. As shown in \\citet{sigstad2023monotonicity}, this condition\nis much more plausible in random-judge designs than \\citet{Imbens1994Identification}\nmonotonicity. Thus, even though conventional MTE analysis assumes\nImbens-Angrist monotonicity, MTE-based LATE estimates can be highly\nrobust to plausible levels of monotonicity violations.\n\nNext, I consider estimates of the average treatment effect on the\ntreated (ATT) and the untreated (ATUT) for the complier population.\nMTE-based ATT (ATUT) estimates are consistent as long as Imbens-Angirst\nmonotonicity holds for all pairs of instrument values involving the\nlowest (highest) instrument value. For instance, in the random-judge\ndesign, these conditions require that the most lenient (stringent)\njudge is most lenient (stringent) in all cases. These conditions are\nmore demanding than the condition required to estimate LATE. Estimates\nof ATT and ATUT are thus more sensitive to monotonicity violations.\n\nI also consider MTE-based estimates of the average treatment effect\n(ATE), which require extrapolation beyond the observed instrument\nvalues. As long as this extrapolation is well specified, MTE-based\nATE estimates are consistent without any monotonicity assumption.\nSuch estimates are equivalent to the \\citet{arnold2021measuring}\napproach to estimating average treatment effects. Finally, I consider\nthe use of MTEs to assess heterogeneous treatment effects by treatment\npropensity. As long as attention is limited to aggregate properties\nof the MTE curve, this practice also requires only mild monotonicity\nassumptions.\n\nWhile these analyses show that MTE-based estimators are relatively\nrobust to monotonicity violations, the intermediate step of estimating\nmarginal treatment effects is not a meaningful exercise when monotonicity\nis violated. Instead, I propose to directly estimate the relevant\ntreatment parameters without first estimating an ``MTE curve''.\nI show that whenever MTE analysis identifies LATE, LATE is identified\nby a standard Wald estimand: the difference in average outcomes between\nagents receiving the highest instrument value and agents receiving\nthe lowest instrument value divided by the difference in treatment\npropensities. Similar results are obtained for the average treatment\neffects on the treated and on the untreated for the complier population.\nThere are several reasons to prefer such a direct estimation of treatment\nparameters over MTE-based estimation when monotonicity is violated.\nFirst, the direct estimation is more honest and clarifies the necessary\nidentification assumptions. Second, the direct estimates can easily\nbe estimated non-parametrically and do not require a fully continuous\ninstrument. Finally, by targeting a specific parameter rather than\nthe full MTE curve, the parameter can be more precisely estimated.\n\n\\section{Marginal Treatment Effects and Monotonicity\\label{sec:theory}}\n\nFix a probability space with the outcome corresponding to a randomly\ndrawn agent. Define the following random variables: A binary treatment\n$D\\in\\left\\{ 0,1\\right\\} $, an outcome $Y\\in\\mathbb{R}$, and a continuous\ninstrument $Z\\in\\mathbb{R}$ with support $\\left[\\underline{z},\\bar{z}\\right]$.\nTo capture the idea that different agents might be induced into treatment\nin different ways by the instrument, define a \\emph{response type}\nas a mapping $s:\\left[\\underline{z},\\bar{z}\\right]\\rightarrow\\left\\{ 0,1\\right\\} $\nfrom instrument values to treatments.\\footnote{Response types were introduced by \\citet{heckman2018unordered}.}\nDenote by the random variable $S$ the response type of the randomly\ndrawn agent. If $S=s$ for agent $i$, then $s\\left(z\\right)=1$ indicates\nthat agent $i$ will receive the treatment if $Z$ is set to $z$.\n Denote by $\\mathcal{S}$ the set of all response types in the population.\nDefine $Y\\left(0\\right)$ and $Y\\left(1\\right)$ as the \\emph{potential\noutcomes} when $D$ is set to $0$ and $1$, respectively. Denote\nby the random variable $\\beta\\equiv Y\\left(1\\right)-Y\\left(0\\right)$\nthe treatment effect of agent $i$. Let $p\\left(z\\right)\\equiv\\E\\left[S\\left(z\\right)\\right]$\nbe the share of agents receiving treatment at $Z=z$. I assume the\nfollowing throughout\n\\begin{assumption}\n\\label{assu:iv}(Exogeneity and Exclusion). $\\left\\{ Y\\left(0\\right),Y\\left(1\\right),S\\right\\} \\perp Z$\n\\end{assumption}\n\\begin{assumption}\n\\label{assu:rank}(First stage). The propensity $p\\left(z\\right)$\nis non-trivial function of $z$.\n\\end{assumption}\nTo simplify the notation, assume (without loss of generality) that\nthe instrument values are labeled such that\n\\begin{assumption}\n\\label{assu:indexed_by_stringency-1-1} $p\\left(z\\right)=z$.\n\\end{assumption}\n\\citet{Imbens1994Identification} monotonicity is then defined by\n\\begin{defn}[Imbens-Angrist Monotonicity]\n For all $z,z'\\in\\mathbb{R}$ and $s\\in\\mathcal{S}$\n\\[\nz\\geq z'\\Rightarrow s\\left(z\\right)\\geq s\\left(z'\\right)\n\\]\n\\end{defn}\nMarginal treatment effects were introduced by \\citet{bjorklund1987estimation}\nand generalized by \\citet{heckman1999local}.\\footnote{See \\citet{heckman2007econometricII}.}\nIn applied work (\\emph{e.g.}, \\citealt{Arnold2018Racial,Bhuller2020Incarceration}),\nmarginal treatment effect analysis relies on a generalized \\citet{roy1951some}\nselection model\n\\[\nD=\\mathbf{1}\\left[Z>U\\right]\n\\]\nwhere $U$ is a random variable.\\footnote{See \\citet{heckman2007econometricI,heckman2007econometricII}. To\nsimplify the exposition, I disregard covariates.} The agent receives treatment if the instrument is above the agent's\nunobserved \\emph{resistance to treatment }$U$. This model implicitly\nassumes Imbens-Angrist monotonicity.\\footnote{Consider two instrument values $z_{1}\\geq z_{2}$. Then $D\\left(z_{2}\\right)\\geq D\\left(z_{1}\\right)$\nfor all agents.} A \\emph{marginal treatment effect} is then defined as the average\ntreatment effect for agents with a given treatment propensity:\n\\[\n\\MTE\\left(u\\right)=\\E\\left[\\beta\\mid U=u\\right]\n\\]\n\nMarginal treatment effects can then be identified using the local\ninstrumental variable approach \\citep{heckman1999local,heckman2005structural}:\n\\[\n\\LIV\\left(u\\right)\\equiv\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}\n\\]\nAssume this derivative exists. Under Imbens-Angrist monotonicity,\nwe have $\\LIV\\left(u\\right)=\\MTE\\left(u\\right)$. But $\\LIV\\left(u\\right)$\nis defined even when Imbens-Angrist monotonicity does not hold.\n\nThe applied literature uses MTE analysis for two purposes. First,\nto estimate meaningful treatment parameters such as LATE and ATE (\\emph{e.g.},\n\\citealt{Arnold2018Racial,Bhuller2020Incarceration}). Second, to\nassess heterogeneous treatment effects based on the treatment propensity\n$U$ by directly inspecting $\\LIV\\left(u\\right)$ (\\emph{e.g.}, \\citealt{doyle2007child,maestas2013does,french2014effect}).\n\n\\subsection{Using MTE to Identify Meaningful Treatment Parameters}\n\n\\citet{heckman1999local,heckman2005structural} showed that many popular\ntreatment parameters---including the average treatment effect (ATE)---can\nbe identified by a weighted average of marginal treatment effects.\nMTE analysis can thus be used to identify more meaningful treatment\nparameters than the weighted average of individual treatment effects\nproduced by 2SLS. Identifying ATEs using MTE analysis, however, requires\nfull support of $Z$ in $\\left[0,1\\right]$ or extrapolation beyond\nthe support of $Z$. Since $Z$ typically does not have full support\nin practice, the literature instead normally seeks to estimate the\nlocal average treatment effect (LATE) for agents receiving treatment\nwhen $Z=\\bar{z}$ and not when $Z=\\underline{z}$---agents with $D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)$.\nThis parameter differs from the 2SLS estimand by placing equal weight\non all compliers. The literature (\\emph{e.g.}, \\citealt{Bhuller2020Incarceration})\nhas also considered the average treatment effect on the treated and\nthe average treatment effect on the untreated for the same population.\nSince these treatment effects are ``local''---defined on the complier\npopulation---I label them LATT and LATUT, respectively. Formally,\ndefine\n\n\\begin{eqnarray*}\n\\LATE & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,S\\left(\\bar{z}\\right)=1\\right]\\\\\n\\LATT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\underline{z}\\right)=0,D=1\\right]\\\\\n\\LATUT & \\equiv & \\E\\left[\\beta\\mid S\\left(\\bar{z}\\right)=1,D=0\\right]\n\\end{eqnarray*}\n\nThe $\\LATE$ parameter is the local average treatment effect for agents\nreceiving treatment under the highest instrument value but not under\nthe lowest instrument value. The $\\LATT$ and $\\LATUT$ parameters\nare the (local) average treatment effects on the treated and the untreated\nfor a similar complier population.\\footnote{The $\\LATT$ and $\\LATUT$ complier population includes all agents\nexcept never-takers and always-takers. The $\\LATE$ complier population\nalso ignores, for instance, response types receiving treatment under\nsome intermediate instrument values but not by the highest nor the\nlowest instrument value. I do not see a way to identify a local average\ntreatment effect that covers also such compliers.} As shown by \\citet{heckman1999local,heckman2005structural}, these\nparameters are identified under Imbens-Angrist monotonicity by:\n\\begin{eqnarray*}\n\\tilde{\\LATE} & \\equiv & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATT} & \\equiv & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\LIV\\left(u\\right)du\\\\\n\\tilde{\\LATUT} & \\equiv & \\frac{1}{\\bar{z}-\\E\\left[Z\\right]}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z<u\\right]\\LIV\\left(u\\right)du\n\\end{eqnarray*}\nWhen Imbens-Angrist monotonicity is violated, however, this method\nmight lead to wrong conclusions. How sensitive are these estimands\nto monotonicity violations? Fortunately, it turns out that MTE analysis\nmight still identify $\\LATE$, $\\LATT$, and $\\LATUT$ even when Imbens-Angrist\nmonotonicity is violated. \n\nFormally, let $\\mathcal{G}$ be the set of all possible joint distributions\nof $\\left(Y\\left(1\\right),Y\\left(0\\right),S\\right)$. To allow for\narbitrary heterogeneous effects, we do not want to place any restrictions\non this joint distribution. The necessary and sufficient conditions\nfor $\\tilde{\\LATE}$, $\\tilde{\\LATT}$, $\\tilde{\\LATUT}$ to be consistent\nunder arbitrary heterogeneous effects are the following much weaker\nmonotonicity conditions:\n\\begin{thm}\n\\label{thm:id1} (Identification results).\n\\end{thm}\n\\begin{description}\n\\item [{i)}] $\\tilde{\\LATE}=\\LATE$ for all $g\\in\\mathcal{G}$ if and only\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\tilde{\\LATT}=\\LATT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$ and $z$.\n\\item [{iii)}] $\\tilde{\\LATUT}=\\LATUT$ for all $g\\in\\mathcal{G}$ if and\nonly if $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\end{description}\nThus, for MTE analysis to identify $\\LATE$, it is sufficient that\nmonotonicity holds between the lowest and the highest instrument value.\nThis condition is substantially weaker than Imbens-Angrist monotonicity,\nespecially when there are many possible instrument values. Similarly,\n$\\LATT$ is identified by MTE analysis whenever monotonicity holds\nfor all instrument value pairs that involve the lowest instrument\nvalue. This condition is stronger than $\\LATE$ condition but still\nconsiderably weaker than Imbens-Angrist monotonicity---monotonicity\nis allowed to be violated for all instrument value pairs that do not\ninclude the lowest instrument value. For MTE analysis to identify\n$\\LATUT$, on the other hand, monotonicity must hold for all instrument\nvalue pairs that involve the \\emph{highest} instrument value.\n\n\\subsection{Estimating ATE by Extrapolating the MTE curve}\n\nWhen $f\\left(u\\right)\\equiv\\E\\left[Y\\mid Z=u\\right]$ is estimated\nparametrically, one might seek to extrapolate beyond the support of\n$Z$ to estimate the average treatment effect, $\\ATE\\equiv\\E\\left[\\beta\\right]$.\nIn particular, let $\\hat{f}:\\left[0,1\\right]\\rightarrow\\mathbb{R}$\nbe an extrapolation of $f$ that covers the full interval $\\left[0,1\\right]$.\nThe corresponding MTE curve is defined by $\\hat{\\LIV}\\left(u\\right)\\equiv\\hat{f}'\\left(u\\right)$.\nOne can then estimate $\\ATE$ by\n\\[\n\\tilde{\\ATE}\\equiv\\int_{0}^{1}\\hat{\\LIV}\\left(u\\right)du\n\\]\nHow do monotonicity violations influence such analysis? By the fundamental\ntheorem of calculus, $\\tilde{\\ATE}=\\hat{f}\\left(1\\right)-\\hat{f}\\left(0\\right)$.\nIf the extrapolation is well specified, $\\hat{f}\\left(1\\right)$ can\nbe thought of as the average outcome for agents in the hypothetical\ncase of receiving $Z=1$.\\footnote{In the context of the judge IV design, it would correspond to the\naverage outcomes for defendants randomly assigned a hypothetical supremely\nstringent judge that always incarcerates.} In that case, $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$.\nSimilarly, $\\hat{f}\\left(0\\right)$ can be thought of as the average\noutcome for agents had they been assigned $Z=0$ which gives $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\nWe thus get that $\\tilde{\\ATE}=\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\right]=\\ATE$\nif the extrapolation is well specified---$\\hat{f}$ is able to identify\nthe average outcome for agents in the hypothetical cases of receiving\n$Z=1$ and $Z=0$. Formally\n\\begin{prop}\n$\\tilde{\\ATE}=\\ATE$ if $\\hat{f}\\left(1\\right)=\\E\\left[Y\\left(1\\right)\\right]$\nand $\\hat{f}\\left(0\\right)=\\E\\left[Y\\left(0\\right)\\right]$.\n\\end{prop}\nThe MTE-based estimator of $\\ATE$ is equivalent to the estimator\nproposed by \\citet{arnold2021measuring}, who extrapolate towards\na supremely lenient judge to estimate the ATE of pre-trial release\non pre-trial misconduct in a judge IV setting. As pointed out by \\citet{arnold2021measuring},\nthis approach does not require any monotonicity assumptions. Thus,\nmonotonicity violations do not affect the validity of this approach.\n\n\\subsection{Using MTE to Analyze Heterogeneous Effects}\n\nThe literature also uses the MTE framework to assess heterogeneous\ntreatment effects based on the treatment propensity $U$ by directly\ninspecting $\\LIV\\left(u\\right)$---the ``MTE curve'' (\\emph{e.g.},\n\\citealt{doyle2007child,maestas2013does,french2014effect}). But $\\LIV\\left(u\\right)$\nis difficult to interpret when Imbens-Angrist monotonicity is violated.\nTo see this, it is instructive to consider $\\LIV\\left(u\\right)$ as\nthe limit of a standard Wald estimand:\n\\[\n\\LIV\\left(u\\right)=\\lim_{v\\rightarrow u}\\tilde{\\LATE}_{u,v}\n\\]\nwhere\n\n\\[\n\\tilde{\\LATE}_{u,v}\\equiv\\frac{\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=v\\right]}{u-v}\n\\]\n\nUnder Imbens-Angrist monotonicity, $\\tilde{\\LATE}_{u,v}$ identifies\n\\[\n\\LATE_{u,v}\\equiv\\E\\left[\\beta\\mid D\\left(u\\right)>D\\left(v\\right)\\right]\n\\]\nthe local average treatment effect for cases where receiving treatment\nat $Z=u$ but not at $Z=v$. As $v$ approaches $u$, however, Imbens-Angrist\nmonotonicity between $v$ and $u$ might be unlikely.\\footnote{In the context of judges, Imbens-Angrist monotonicity is less likely\nfor judge pairs with similar stringencies than for judge pairs with\nmore different stringencies \\citep{sigstad2023monotonicity}. } Individual points of the MTE curve are then hard to interpret. But\nlooking at more aggregate properties of the MTE curve could still\nbe meaningful. For instance, the average of $\\LIV\\left(u\\right)$\nacross a range $u\\in\\left[\\underline{u},\\bar{u}\\right]$ identifies\nLATE for agents receiving treatment at $Z=\\bar{u}$ but not at $Z=\\underline{u}$\nwhen monotonicity holds between these instrument values:\n\\begin{prop}\n\\label{prop:MTE-curve}\n\\[\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right]=\\LATE_{\\underline{u},\\bar{u}}\n\\]\nfor all $g\\in\\mathcal{G}$ if and only if $s\\left(\\bar{u}\\right)\\geq s\\left(\\underline{u}\\right)$\nfor all $s\\in\\mathcal{S}$.\n\\end{prop}\n\nAs $\\bar{u}$ and $\\underline{u}$ become more distant, monotonicity\nbetween these two values typically becomes more plausible.\\footnote{This is at least true for the random-judge design \\citep{sigstad2023monotonicity}.}\n\n\\subsection{Identifying Meaningful Treatment Effects without MTE\\label{subsec:without-MTE-1}}\n\nWhile MTE analysis gives correct results under weaker assumptions\nthan Imbens-Angrist monotonicity, the ``MTE curve'' $\\LIV\\left(u\\right)$\nis not a meaningful object when monotonicity is violated. A more honest\napproach is to estimate aggregate treatment effects directly, without\nfirst estimating an MTE curve. The following results show how LATE,\nLATT, and LATUT can be directly identified without first estimating\n$\\LIV\\left(u\\right)$.\n\\begin{thm}\n\\label{thm:id2} (Identifying meaningful treatment effects without\nMTE analysis).\n\\begin{description}\n\\item [{i)}] $\\LATE=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\bar{z}-\\underline{z}}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(\\underline{z}\\right)$ for all\n$s\\in\\mathcal{S}$.\n\\item [{ii)}] $\\LATT=\\frac{\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]}{\\E\\left[Z\\right]-\\underline{z}}$\nif $s\\left(z\\right)\\geq s\\left(\\underline{z}\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iii)}] $\\LATUT=\\frac{\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\right]}{\\bar{z}-\\E\\left[Z\\right]}$\nif $s\\left(\\bar{z}\\right)\\geq s\\left(z\\right)$ for all $s\\in\\mathcal{S}$\nand $z$.\n\\item [{iv)}] $\\LATE_{z_{1},z_{2}}=\\frac{\\E\\left[Y\\mid Z=z_{1}\\right]-\\E\\left[Y\\mid Z=z_{2}\\right]}{z_{1}-z_{2}}$\nif $s\\left(z_{1}\\right)\\geq s\\left(z_{2}\\right)$ for all $s\\in\\mathcal{S}$.\n\\end{description}\n\\end{thm}\nIn particular, $\\LATE$ is identified by the standard Wald estimand\nof the effect of receiving the highest instrument value compared to\nreceiving the lowest instrument value.\\footnote{A similar estimand is discussed by \\citet{frolich2007nonparametric}\n(Theorem 8).} Furthermore, $\\LATT$ and $\\LATUT$ are identified by the difference\nbetween the mean outcome and the expected outcomes for agents receiving\nthe lowest and highest instrument values, respectively. The only parameters\nthat need to be estimated are thus $\\bar{z}$, $\\underline{z}$, $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\nand $\\E\\left[Y\\mid Z=\\bar{z}\\right]$. There are two advantages of\nthis approach. First, it is not needed to estimate a full MTE curve.\nEstimating an MTE curve is difficult in practice due to data limitations\nand typically requires parametric assumptions. When the aim is to\nestimate only $\\E\\left[Y\\mid Z=\\underline{z}\\right]$ and $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\ninstead of the full MTE curve, one can do this non-parametrically.\\footnote{For instance, one can directly estimate $\\E\\left[Y\\mid Z=\\bar{z}\\right]$\nusing the sample analog, or one can estimate it using a local linear\nregression (with, \\emph{e.g.}, a triangular kernel) on a sample of\nthe highest instrument values. Note that such LATE estimates (obtained\neither through MTE analysis or the Wald approach) essentially ignore\nagents receiving medium instrument values. These estimates will thus\ntypically be less precise than 2SLS estimates which exploit all instrument\nvalues. Also, note that in finite samples, the sample analog of $\\bar{z}-\\underline{z}$\nwill be upward biased. For instance, even if all instrument values\nhave the same treatment propensity ($\\bar{z}=\\underline{z}$), the\nsample analog of $\\bar{z}-\\underline{z}$ will still be positive.\nTo avoid this bias, one could use a split-sample approach: Estimate\nwhich instrument values are associated with the highest and lowest\ntreatment propensities in one sample and estimate the treatment propensities\nassociated with these instrument values in another sample. I leave\na thorough discussion of inference to future research.} Second, the results above are valid also for discrete instruments\nwhen MTE analysis is not applicable.\\footnote{For instance, applying MTE-analysis in the judge IV setting formally\nrequires a continuum of judges.}\n\n\\section{Conclusions\\label{sec:conclusions}}\n\nMarginal treatment effects can be used to estimate more meaningful\ntreatment parameters than two-stage least squares but require Imbens-Angrist\nmonotonicity. In this note, I have presented conditions under which\nMTE-based estimates still identify the parameters of interest when\nImbens-Angrist monotonicity is violated. I also showed how the same\nparameters can be identified without relying on the MTE framework.\nI leave questions of estimation for future work.\n\n\\small\n\n\\bibliographystyle{authordate3}\n\\bibliography{references}\n\n\\normalsize\n\n\\clearpage{}\n\n\\appendix\n\n\\section{Proofs}\n\\begin{proof}\n(Theorem \\ref{thm:id1}.) \\emph{Part i).}\n\\begin{eqnarray*}\n\\tilde{\\LATE} & = & \\frac{1}{\\bar{z}-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[Y\\mid Z=\\bar{z}\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\bar{z}-\\underline{z}}\\left(\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\bar{z}\\right]-\\E\\left[DY\\left(1\\right)-\\left(1-D\\right)Y\\left(0\\right)\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)>D\\left(\\underline{z}\\right)\\right]\\\\\n & - & \\frac{\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]}{\\bar{z}-\\underline{z}}\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]\n\\end{eqnarray*}\nThe first equality invokes the fundamental theorem of calculus and\nthe fourth equality uses Assumption \\ref{assu:iv}. This expression\nequals $\\LATE$ for all $g\\in\\mathcal{G}$ if and only if $\\Pr\\left[D\\left(\\bar{z}\\right)<D\\left(\\underline{z}\\right)\\right]=0$.\n\n\\emph{Part ii).} \\emph{Let $f\\left(u\\right)$ denote the density of\n$Z$ at $u$. Then}\n\\begin{eqnarray*}\n\\tilde{\\LATT} & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\Pr\\left[Z>u\\right]\\frac{d\\E\\left[Y\\mid Z=u\\right]}{du}du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\int_{\\underline{z}}^{\\bar{z}}\\left(\\E\\left[Y\\mid Z=u\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)f\\left(u\\right)du\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\left(\\E\\left[Y\\right]-\\E\\left[Y\\mid Z=\\underline{z}\\right]\\right)\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[Y\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[DY\\left(1\\right)+\\left(1-D\\right)Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)\\mid S\\right]+\\left(1-\\E\\left[D\\mid S\\right]\\right)\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\\\\\n & = & \\frac{1}{\\E\\left[Z\\right]-\\underline{z}}\\E\\left[\\E\\left[D\\mid S\\right]\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S\\right]+\\E\\left[Y\\left(0\\right)\\mid S\\right]-\\E\\left[Y\\mid Z=\\underline{z},S\\right]\\right]\n\\end{eqnarray*}\nThe second equality uses that both integrals represent the area between\nthe curve $\\E\\left[Y\\mid Z=u\\right]$ and $\\E\\left[Y\\mid Z=\\underline{z}\\right]$\n(weighted by the density $f$). The fourth equality uses the law of\niterated expectations, and the sixth equality invokes Assumption \\ref{assu:iv}.\nFor this to equal \n\\begin{eqnarray*}\n\\LATT & = & \\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right),D=1\\right]\\\\\n & = & \\frac{1}{\\E\\left[D\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]}\\E\\left[D\\left(Y\\left(1\\right)-Y\\left(0\\right)\\right)\\mid D\\left(\\underline{z}\\right)<D\\left(\\bar{z}\\right)\\right]\n\\end{eqnarray*}\n for all $g\\in\\mathcal{G}$, we need that for each $s\\in\\mathcal{S}$,\neither $s\\left(\\underline{z}\\right)=0$ or $\\E\\left[D\\mid S=s\\right]=1$.\\footnote{If $\\E\\left[D\\mid S=s\\right]<1$ and $s\\left(\\underline{z}\\right)=1$\nfor a response type $s\\in\\mathcal{S}$, $\\tilde{\\LATT}$ will---unlike\n$\\LATT$---place a negative weight on $\\E\\left[Y\\left(1\\right)-Y\\left(0\\right)\\mid S=s\\right]$.\nIt is straightforward to check that the expressions for $\\tilde{\\LATT}$\nand $\\LATT$ coincide when either $s\\left(\\underline{z}\\right)=0$\nor $\\E\\left[D\\mid S=s\\right]=1$ for all $s\\in\\mathcal{S}$.} In other words, we need $D\\left(z\\right)\\geq D\\left(\\underline{z}\\right)$\nfor all $z$. The proof of part iii) is analogous to part ii).\n\\end{proof}\n\\begin{proof}\n(Theorem \\ref{thm:id2}.) This follows from the proof of Theorem \\ref{thm:id1}.\n\\end{proof}\n\\begin{proof}\n(Proposition \\ref{prop:MTE-curve}.)\n\\begin{eqnarray*}\n\\E\\left[\\LIV\\left(U\\right)\\mid\\underline{u}\\leq U\\leq\\bar{u}\\right] & = & \\frac{1}{\\bar{u}-\\underline{u}}\\int_{\\underline{u}}^{\\bar{u}}\\LIV\\left(u\\right)du\\\\\n & = & \\frac{\\E\\left[Y\\mid Z=\\bar{u}\\right]-\\E\\left[Y\\mid Z=\\underline{u}\\right]}{\\bar{u}-\\underline{u}}\n\\end{eqnarray*}\n\nThe latter Wald estimand identifies $\\LATE_{\\underline{u},\\bar{u}}$\nfor all $g\\in\\mathcal{G}$ if and only if there are no ``defiers'',\n$\\Pr\\left[D\\left(\\underline{u}\\right)>D\\left(\\bar{u}\\right)\\right]=0$.\n\\end{proof}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
