{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Switzerland","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"ETH Zurich","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at ETH Zurich in Switzerland. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Switzerland","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Lausanne","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Lausanne in Switzerland. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 6\n4. Understandability: 8\n5. Relevance: 7\n6. Quality of Citations: 7\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 7.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Switzerland","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Zurich University of Applied Sciences (ZHAW)","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Zurich University of Applied Sciences (ZHAW) in Switzerland. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 9\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"England","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Cambridge","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Cambridge in England. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 8\n4. Understandability: 9\n5. Relevance: 8\n6. Quality of Citations: 7\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"England","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Dundee","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Dundee in England. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"England","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Wolverhampton","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Wolverhampton in England. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"China","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Peking University","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Peking University in China. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8.25"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"China","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Dalian University of Technology","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Dalian University of Technology in China. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 8\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"China","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"China University of Mining and Technology","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at China University of Mining and Technology in China. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"India","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Indian Institute of Technology Bombay (IITB)","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Indian Institute of Technology Bombay (IITB) in India. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 7\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 7.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"India","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Delhi","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Delhi in India. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"India","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Indian Institute of Technology Hyderabad (IITH)","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Indian Institute of Technology Hyderabad (IITH) in India. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Iran","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Sharif University of Technology","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Sharif University of Technology in Iran. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.0"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Iran","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Shiraz University","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Shiraz University in Iran. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 9\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Iran","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Ferdowsi University of Mashhad","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Ferdowsi University of Mashhad in Iran. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"USA","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Massachusetts Institute of Technology","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Massachusetts Institute of Technology in USA. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 8\n6. Quality of Citations: 7\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 7.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"USA","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Houston","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Houston in USA. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"USA","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Western Washington University","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Western Washington University in USA. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Brazil","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Sao Paulo","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Sao Paulo in Brazil. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 8\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Brazil","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Universidade de Bras\u00edlia","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Universidade de Bras\u00edlia in Brazil. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Brazil","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Pontif\u00edcia Universidade Cat\u00f3lica do Rio Grande do Sul, PUCRS","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Pontif\u00edcia Universidade Cat\u00f3lica do Rio Grande do Sul, PUCRS in Brazil. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Egypt","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Cairo University","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Cairo University in Egypt. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Egypt","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Alexandria University","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Alexandria University in Egypt. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 7\n4. Understandability: 9\n5. Relevance: 8\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Egypt","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Zagazig University","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Zagazig University in Egypt. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 9\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Australia","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"The University of Melbourne","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at The University of Melbourne in Australia. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 9\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 10\n8. Overall score: 9"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Australia","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"The University of Adelaide","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at The University of Adelaide in Australia. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 9\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 9\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Australia","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Queensland University of Technology (QUT)","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Queensland University of Technology (QUT) in Australia. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Germany","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Technical University of Munich","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Technical University of Munich in Germany. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8.0"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Germany","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Potsdam","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Potsdam in Germany. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 7\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"Germany","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"Leibniz University Hannover","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at Leibniz University Hannover in Germany. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 8\n2. Method: 7\n3. Credibility: 8\n4. Understandability: 9\n5. Relevance: 7\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"South Africa","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of Cape Town","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of Cape Town in South Africa. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 7\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 8\n8. Overall score: 8.0"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"South Africa","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of South Africa","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of South Africa in South Africa. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 8\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
{"title":"CP_paper_19","field":"Quantitative Finance","country_association":"South Africa","uni_association":null,"paper_ltx":"\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","input_length":12062,"university_association":"University of the Free State","rating_prompt":"Rate the quality of the paper according to the following criteria on a scale from 1 (worst) to 10 (best). The paper is by researchers at University of the Free State in South Africa. Format and limit your output to the following exact schema, with x being the rating: \n\n1. Originality: x\n2. Method: x\n3. Credibility: x\n4. Understandability: x\n5. Relevance: x\n6. Quality of Citations: x\n7. Linguistic style and soundness of grammar: x\n8. Overall score: x\n\n\n\n\\begin{document}\n\n\\title{Experimental Analysis of Deep Hedging Using Artificial Market Simulations for Underlying Asset Simulators}\n\\maketitle\n\n\\begin{abstract}\n    Derivative hedging and pricing are important and continuously studied topics in financial markets.\n    Recently, deep hedging has been proposed as a promising approach that uses deep learning to approximate the optimal hedging strategy and can handle incomplete markets.\n    However, deep hedging usually requires underlying asset simulations, and it is challenging to select the best model for such simulations.\n    This study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\n    Artificial market simulations can replicate the stylized facts of financial markets, and they seem to be a promising approach for deep hedging.\n    We investigate the effectiveness of the proposed approach by comparing its results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\n    The results show that the proposed approach can achieve almost the same level of performance as the traditional approach without mathematical finance models.\n    Finally, we also reveal that the proposed approach has some limitations in terms of performance under certain conditions.\n\\end{abstract}\n\n\\begin{IEEEkeywords}\n    deep hedging, artificial market simulation, financial markets, derivative, hedging\n\\end{IEEEkeywords}\n\n\\section{Introduction}\nDerivative hedging and pricing are important matters in financial markets regarding asset risk management.\nA derivative is a financial instrument whose value depends on that of an underlying asset.\nIt is frequently used to hedge the risk that cannot be directly hedged using only the underlying asset.\nMoreover, it is important to price and hedge the risk of derivatives for security companies that issue derivatives.\nTherefore, derivative pricing and hedging have been extensively studied.\n\nMany methods exist for derivative pricing and hedging.\nTraditionally, mathematical finance models, such as the Black--Scholes model \\cite{black1973,merton1973}, are used for pricing and hedging.\nAlthough these models are useful, they also have some limitations.\nFor example, they assume complete markets, which means that there are no frictions such as transaction costs and liquidity.\nTo solve this problem, some researchers have proposed a new model called deep hedging \\cite{deep-hedging}.\nDeep hedging is a model based on deep learning that can handle incomplete markets.\nIt uses neural networks to approximate the optimal hedging strategy and Monte Carlo simulations to evaluate the derivative price.\nBecause of these features, deep hedging can be used in more practical situations than traditional models.\nIn addition to those features, a notable advantage of deep hedging is its ability to use risk measure functions as objective functions.\n\nDeep hedging is a promising model; however, there are some difficulties in selecting underlying asset simulations.\nNon-stationarity exists in the actual financial markets, making it difficult to learn using only historical data.\nTherefore, data augmentation via Monte Carlo simulations is used to learn about the markets in deep hedging.\nHowever, many candidate models exist for Monte Carlo simulations of underlying assets, and it is difficult to select the best one.\nFor example, the geometric Brownian motion model is a simple model for the simulations; Buehler {\\it et al.} \\cite{deep-hedging} originally used the Heston model \\cite{Heston1993}, which is a stochastic volatility model for simulations.\nHarvath {\\it et al.} \\cite{Horvath2021} used a rough volatility model called rBergomi \\cite{Bayer2015} for the simulations, and the jump-diffusion model \\cite{Cox1976,Merton1976} could also be used for the simulations.\nHowever, mathematical finance models are not always suitable because they do not consider the stylized facts of actual financial markets.\nTherefore, selecting the best model for simulations is difficult.\n\nArtificial market simulations are a promising approach for replicating stylized facts.\nArtificial market simulations are financial market simulations that use multi-agent simulations.\nFinancial markets are highly complex because of the interactions between traders and markets, and there is no dominant equation for the phenomena occurring in financial markets.\nTherefore, multi-agent simulations, in which agents can interact with each other, are necessary to reproduce well-known phenomena in financial markets.\nFor example, \\cite{Lux1999} showed that in financial market simulations, interactions between agents (traders) were necessary to replicate common phenomena in financial markets.\nIn addition, \\cite{CI2002} showed that the stylized facts of financial markets can be replicated using multi-agent simulations based on fundamental, chart, and noise factors.\n\nThis study uses artificial market simulations for underlying asset simulations in deep hedging.\nA similar study \\cite{Gao2023} merged mathematical finance models and Chiarella {\\it et al.} artificial market model \\cite{CI2002}.\nHowever, no study has used artificial market simulations for underlying asset simulations in deep hedging without mathematical finance models.\nTherefore, we only use artificial market simulations for underlying asset simulations in deep hedging while investigating the effectiveness of this approach.\n\nThe contributions of this study are as follows:\n\\begin{itemize}\n    \\item We propose a new approach to use artificial market simulations for underlying asset simulations in deep hedging.\n    \\item We investigate the effectiveness of the approach by comparing the results with those of the traditional approach.\n    \\item We show that the proposed approach can achieve almost the same performance as the traditional approach without mathematical finance models.\n    \\item But, we also show that the proposed approach has some limitations in terms of performance under some conditions.\n\\end{itemize}\n\n\\section{Related Works}\nMathematical finance approaches have been frequently used in terms of option hedging and prices.\nThe celebrated Black--Scholes model \\cite{black1973,merton1973} is certainly the most famous model in the option pricing literature.\nTo date, the Black-Scholes model has been widely used in practice.\nIts applications include deriving option pricing formulae (e.g., the Black-Scholes formula) and analyzing structures of option prices (e.g., Greeks).\n\nAdvances in neural networks have opened up a new avenue of research on nonparametric approaches to option pricing and hedging.\nHutchinson {\\it et al.} \\cite{Hutchinson1994} and Garcia {\\it et al.} \\cite{Garcia2000} showed that a multilayer perceptron (MLP) could replace the Black--Scholes model.\nMalliaris {\\it et al.} \\cite{Malliaris1996} showed that neural networks could predict implied volatility by using the index option of the S\\&P100.\nFor a comprehensive review, see Ruf and Wang \\cite{Ruf2020} and the references therein.\n\nIn their seminal work \\cite{deep-hedging,Buehler2019b}, Buehler {\\it et al.} proposed a method called \\emph{Deep Hedging}.\nDeep hedging utilizes neural networks to model hedging strategies and construct optimal strategies by directly maximizing the utility functions derived from the final Profit \\& Loss (PL).\nDeep hedging has been recognized as a breakthrough in the derivative industry owing to two prominent features.\nFirst, deep hedging can handle various types of friction using a fully computational approach.\nSecond, deep hedging bypasses the need for theoretical pricing models, which are prerequisites for other standard hedging methods, such as those based on Greeks.\nSince the introduction of deep hedging, considerable efforts have been devoted to expanding its versatility.\nImaki {\\it et al.} \\cite{Imaki2023} proposed a deep hedging model that incorporated a no-transaction band \\cite{Davis1993} into the neural network architecture, resulting in fast convergence of learning.\nMurray {\\it et al.} \\cite{Murray2022-nz, Buehler2022-nr} proposed actor-critic-based reinforcement learning for deep hedging and achieved a performance almost equivalent to that of the original deep hedging.\nHirano {\\it et al.} \\cite{Hirano2023-iiaiaai-ndh} extended the deep hedging framework into a nested structure, thereby facilitating the use of options as hedging instruments. The authors also proposed efficient simulation designs and a learning algorithm to circumvent the computational issues.\n\nSeveral recent studies focus on the data used for learning deep hedging.\nIn conventional deep hedging \\cite{deep-hedging}, a simulator based on the Heston model \\cite{Heston1993} was used for training.\nMikkila {\\it et al.} \\cite{Mikkila2023-gk} argued that deep hedging often depends on a specific choice of price process simulator, which could result in suboptimal performance. They suggested that improved performance could be achieved by utilizing empirical data for training. However, the amount of historical market data available is often limited.\nHorvath {\\it et al.} \\cite{Horvath2021} proposed a deep hedging model based on rough volatility models, such as the rBergomi model \\cite{Bayer2015}, which could model (non-Markov) jumps in price processes.\n\nAmong the numerous simulators of price processes, it is extremely challenging to determine which one is appropriate or whether a simulator should be used or otherwise.\nThis paper proposes a new approach to using artificial market simulations for underlying asset simulations in deep hedging.\n\\cite{Gao2023} have already proposed a new model merging mathematical finance models and Chiarella {\\it et al.}'s artificial market model \\cite{CI2002}.\nHowever, the benefits of artificial market simulations are not fully utilized in their model, which still retains the features of mathematical finance models.\n\nOriginally, multi-agent simulations have been used to analyze and understand many social phenomena since around the 1970s \\cite{schelling1969,schelling1969}, but they have also been employed in financial markets.\nLux et al.\\cite{Lux1999} highlighted the necessity of a multi-agent simulation by demonstrating that the well-known phenomena observed in financial markets cannot be reproduced without the interaction between agents in the simulations.\nBraun-Munzinger et al.\\cite{Braun-Munzinger2016} constructed a multi-agent simulation for the bond market.\n\nSocial phenomena, especially in financial markets, are difficult to analyze because no dominant equation exists or has been elucidated.\nTherefore, simulations are useful in the social science field \\cite{Edmonds2005}.\nIn particular, various studies argue that multi-agent simulations are important\\cite{Farmer2009,Battiston2016}.\nFurthermore, Mizuta\\cite{Mizuta2019} argued that multi-agent simulations in finance can contribute to financial regulation and system design.\nThe limitations of existing financial approaches are being argued by financial dignitaries, accelerating research on artificial market simulation.\nThe 2007--2008 financial crisis caused the collapse of investment banks and a global financial market network due to the default on housing loans in the U.S.\nTrichet, the European Central Bank (ECB) president at the time, not only stated that traditional financial theory did not help make policy decisions during the financial crisis but also emphasized the need for behavioral economics and multi-agent simulation\\cite{Trichet2011}.\nBookstaber, who has worked in risk management at investment banks and hedge funds and has also worked at the U.S. Treasury, argued for a paradigm shift to methods that could incorporate complexity, such as multi-agent simulation, in his book\\cite{Bookstaber2017}, reflecting on the financial crisis.\nIt claims that traditional economic theory is difficult to apply in times of crisis because distortions are amplified.\n\nVarious studies have adopted artificial market simulation.\nCui et al.\\cite{Cui2012} showed that it is impossible to reproduce certain phenomena observed in the stock market using only zero-intelligence agents.\nTorii et al.\\cite{Torii2015} conducted a simulation where price shocks spread to other stocks and analyzed the mechanism.\nMizuta et al.\\cite{Mizuta2016} analyzed the impact of price quotation (minimum price unit) in the stock market using artificial markets and argued that lowering price quotation was necessary to maintain market share, thereby contributing to discussions on lowering price quotation on the Tokyo Stock Exchange.\nHirano et al.\\cite{Hirano2020c} used artificial markets to analyze the impact of capital adequacy ratio regulation, showing that capital adequacy ratio regulation, which was supposed to have been introduced to ensure market stability, could amplify price shocks and suppress price increases.\nSome studies reproduce flash crashes in artificial markets\\cite{Leal2019,Paddrik2012}.\n\nAccording to such studies, artificial market simulations are useful for analyzing and understanding financial markets.\nThey could also be useful for deep hedging by replicating the underlying asset price movements in actual financial markets.\n\n\\section{Task Setting}\nThis study considers the problem of hedging an option with its underlying asset.\nIn this task, an option is sold at the beginning, and hedging it using its underlying asset is required until maturity.\nThe option payoff construct remains unknown, and its payment risk should be reduced.\n\nWe consider a discrete-time financial market with a finite time horizon $T$ and trading dates $0=t_0 < t_1 < \\cdots < t_n = T$.\nAt $t=t_0$, the hedger (the issuer of the option) sells one unit of the option.\nThe hedger aims to hedge the risk arising from the future payoff of the option by trading the underlying asset $S$.\n$S$ is always assumed to be tradable, and its price at time $t$ is denoted as $S_t$.\nOn each trading date $t_i$, the hedger sets a new position $\\delta_{t_i}$ in $S$.\nThis means that the trader can sell or buy an underlying asset $S$ at $t=t_0, t_1, \\cdots, t_{n-1}$ and the clearance for both the option and the  underlying asset is carried at maturity $t=t_n (=T)$.\nFor simplification, we ignore the risk-free rate, which can be considered all values calculated as discounted if we assume no risk-free rate change occurs.\nThe proportional cost, whose cost coefficient for transaction prices is $c$, is charged for all transactions.\nFor all transactions of $S$, a proportional transaction cost is charged at $c$ per unit price.\n\nOption $Z$ is an option whose underlying asset is $S$.\n$Z$ have payoff $Z(S)$ at the maturity $t=T$.\nExamples include an European option $Z(S) = \\max(S_T-K, 0)$ and a Lookback option $Z(S) = \\max(\\max(S)- K, 0)$, where $K$ denotes the strike value of the options.\nThese options will also be used in our experiments.\n\nIn this study, we consider the sell-side trader of options.\nThis means that the trader shorts (sells) one unit of option, hedges it until maturity, and then pays the payoff $Z(S)$ to the buyer at maturity.\nThe Profit \\& Loss (PL) of the hedger (the issuer) is formulated as follows:\n\\begin{eqnarray}\n    \\mathrm{PL}_T (Z, S, \\delta) &:=& -Z(S) + (\\delta\\cdot S)_T - C_T (\\delta)\\label{eq:pl}\\\\\n    (\\delta\\cdot S)_T &:=& \\sum_{i=0}^{n-1} \\delta_{t_i} (S_{t_{i+1}} - S_{t_i}) \\\\\n    C_T (\\delta) &:=& \\sum_{i=0}^{n} cS_{t_i}|\\delta_{t_i} - \\delta_{t_{i-1}}|\n\\end{eqnarray}\nwhere $\\delta_{-1} = \\delta_{t_n} = 0$.\nHere, $(\\delta\\cdot S)_T$ is the total return resulting from the trading of the underlying asset, and $C_T (\\delta)$ is the total transaction cost.\n\nThe objective function of the hedger is defined by the PL and the utility function $u$.\nSpecifically, the loss function to be minimized is defined as follows:\n\\begin{eqnarray}\n    l(\\delta) = - u \\left(\\mathrm{PL}_T(Z, S, \\delta)\\right).\n\\end{eqnarray}\nFor an example of the utility function $u$, entropic risk measure (ERM) is defined as\n\\begin{eqnarray}\n    u(x) = -\\frac{1}{\\lambda}\\log\\mathbb{E}\\left[\\exp{(-\\lambda x)}\\right]\\label{eq:erm}\n\\end{eqnarray}\nwhere $\\lambda$ is the risk preference coefficient.\nExpected shortfall (conditional value at risk; CVaR) is defined as\n\\begin{eqnarray}\n    u(x) = \\frac{1}{1-\\alpha} \\int_{-\\infty}^{\\mathrm{VaR}(\\alpha)} x\\cdot p(x)dx\\label{eq:cvar}\n\\end{eqnarray}\nwhere $\\alpha$ is the confidence level and satisfies $0\\leq\\alpha\\leq 1$.\n\nThe option price $p$ is estimated using\n\\begin{eqnarray}\n    \\mathbbm{E}\\left[u \\left(\\mathrm{PL}_T(Z, S, \\delta) + p\\right)\\right] = u(0).\n\\end{eqnarray}\nHere, the lower price $p$ implies a highly efficient hedging strategy.\n\n\\section{Artificial Market Simulations}\nThis study employed a typical artificial market simulation model based on \\cite{Torii2015}.\nIn our simulation, 100 stylized trader agents exist, and 1 continuous double auction market exists.\nOn each step of the simulation, $N_{\\mathrm{agent\/step}}$ agents among the 100 agents are randomly selected, and they trade on the market according to the algorithm described below.\nFurthermore, if the market board is thin at the beginning of the simulation, the market's liquidity will reduce, and the situation will not be similar to the actual market.\nTherefore, we employ a pre-opening session before the main session to increase market liquidity.\nIn the following, the total number of steps over the pre-opening and main sessions is denoted as $t$\n\nAt time $t$, the stylized trader agent $i$ decides on its trading actions using the following criteria: fundamentals, chartists (trends), and noise.\nInitially, the agents calculate these three factors.\n\\begin{itemize}\n    \\item Fundamental factor:\n          \\begin{equation}\n              F_t^i = \\frac{1}{\\tau^{*i}} \\ln{\\left\\{\\frac{p_t^*}{p_t}\\right\\}}.\n          \\end{equation}\n          where $\\tau^{*i}$ is agent $i$'s mean reversion-time constant, $p_t^*$ is the fundamental price at time $t$, and $p_t$ is the price at time $t$. The fundamental price starts at 1.0 and is generated by a Brownian motion with a volatility of $\\sigma^{*}$.\n    \\item Chartist factor:\n          \\begin{equation}\n              C_t^i = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i} r_{(t-j)} = \\frac{1}{\\tau^i}\\sum_{j=1}^{\\tau^i}\\ln{\\frac{p_{(t-j)}}{p_{(t-j-1)}}},\n          \\end{equation}\n          where $\\tau^i$ is the time window size of agent $i$ and $r_t$ is the logarithm of return at time $t$.\n    \\item Noise factor:\n          \\begin{equation}\n              N_t^i \\sim \\mathcal{N} (0, \\sigma).\n          \\end{equation}\n          denotes that $N_t^i$ obeys a normal distribution with zero mean and variance $(\\sigma)^2$.\n\\end{itemize}\n\nSubsequently, the agents calculate the weighted averages of these three factors.\n\\begin{equation}\n    \\widehat{r_t^i} = \\frac{1}{w_F^i + w_C^i + w_N^i} \\left(w_F^i F_t^i + w_C^i C_t^i + w_N^i N_t^i\\right),\n\\end{equation}\nwhere $w_F^i, w_C^i$, and $w_N^i$ are the weights of agent $i$ for each factor.\n\nNext, the expected price of agent $i$ is calculated using the following equation:\n\\begin{equation}\n    \\widehat{p_t^i} = p_t \\exp{\\left(\\widehat{r_t^i} \\tau^i\\right)}.\n\\end{equation}\n\nSubsequently, using a fixed margin of $k^i \\in [k_{\\mathrm{min}}, k_{\\mathrm{max}}]$, we determine the actual order prices using the following rules:\n\\begin{itemize}\n    \\item If $\\widehat{p_t^i} > p_t$, agent $i$ places a bid (buy order) at the price\n          \\begin{equation}\n              \\min{\\left\\{\\widehat{p_t^i} (1-k^i), p_{t}^{\\mathrm{bid}}\\right\\}}.\n          \\end{equation}\n    \\item If $\\widehat{p_t^i} < p_t$, agent $i$ places an ask (sell order) at the price\n          \\begin{equation}\n              \\max{\\left\\{\\widehat{p_t^i} (1+k^i), p_{t}^{\\mathrm{ask}}\\right\\}}.\n          \\end{equation}\n\\end{itemize}\nHere, $p_{t}^{\\mathrm{bid}}$ and $p_{t}^{\\mathrm{ask}}$ denote the best bid and ask prices, respectively.\n\nThe parameters of the artificial market simulation are tuned in the experiments.\n\n\\section{Experiments}\nThis section describes the experiments conducted to evaluate the effectiveness of the proposed approach using artificial market simulations for underlying asset $S$ simulations in deep hedging.\nWe compare the proposed approach's results with those of the traditional approach, which uses mathematical finance models such as Brownian motion and Heston models for underlying asset simulations.\nBrownian motion is defined as\n\\begin{eqnarray}\n    \\Delta S_{t_i} = S_{t_i} ( \\mu + \\sigma \\delta W_{t_i})\n\\end{eqnarray}\nwhere $\\delta W_{t_i}$ is an independent normal random variable and $\\sigma$ is the volatility of the underlying asset.\nHeston model is defined as\n\\begin{eqnarray}\n    d S_t &=& S_t \\sqrt{V_t} dW^{(1)}_t\\\\\n    dV_t &=& \\kappa (\\theta - V_t) dt + \\sigma \\sqrt{V_t} dW^{(2)}_t\n\\end{eqnarray}\nwhere $dW^{(1)}_t$ and $dW^{(2)}_t$ are the Winner processes whose correlation is $\\rho$.\nQE-M Method \\cite{andersen2007} is used to simulate the Heston model.\n\nAs the derivatives $Z$ for this experiment, we use European and Lookback options whose maturity and strike price are 20 days and 1.0, respectively.\nFor the utility function $u$ ERM($\\lambda = 1, 10$) and CVaR($\\alpha = 0.90, 0.95, 0.99$) are used.\nExperiments are carried out for those combinations of derivatives and utility functions.\nFor evaluation, we employed the following actual market data:\n\\begin{itemize}\n    \\item S\\&P 500: American S\\&P 500 index from January 2000 to August 2022\n    \\item S\\&P 500 (old): American S\\&P 500 index from January 1931 to December 1950\n    \\item BVSP: Brazilian Bovespa(BVSP) index from January 2000 to August 2022\n\\end{itemize}\nAmong the three datasets, S\\&P 500 is used for the model development data, and the others are used for the test data.\n\nThe flow of the experiments is as follows:\n\\begin{enumerate}\n    \\item The parameters of the artificial market simulation are tunned using Optuna \\cite{optuna_2019}, one of the Bayesian estimation-based hyperparameter optimization libraries. The tuning process is repeated 500 times. In each trial, the following process, that is, a) and b), is repeated:\n          \\begin{enumerate}\n              \\item generates 10,000 paths of price time series for the underlying assets using artificial market simulation, Brownian motion, or Heston model. Then, the training of deep hedging is carried out for 100 epochs.\n              \\item evaluate the performance of the trained deep hedging models. To get the best performances, we employed the best-performing models among the 100 epochs in terms of the pricing over S\\&P 500 (old) data. Then, the best pricing is used as the objective value of tuning.\n          \\end{enumerate}\n    \\item The final evaluation is carried out using S\\&P 500 and BVSP data.\n\\end{enumerate}\n\nFor the implementation, we used the Python--based artificial market simulation PAMS\\cite{Hirano2023-pams} and the Python and pytorch--based pfhedge\\cite{pfhedge} for Deep Hedging.\nThe deep hedging model employs moneyness, time-to-maturity, volatility, Black--Scholes Delta, and historical maximum value of moneyness (only for Lookback) as inputs, and a 32-dimensional 4-layer MLP with ReLU and Layer Normaliuzation\\cite{Ba2016} was employed.\nAdam was employed as an optimizer.\n\nThe parameters to be tuned are as follows and are discretized to improve interpretability.\n\\begin{itemize}\n    \\item Training parameters:\\begin{itemize}\n              \\item Learning rate: $10^{-1}$, $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n          \\end{itemize}\n    \\item Brownian Motion:\\begin{itemize}\n              \\item Mean return ($\\mu$): $-0.25$, $-0.20$, ... , $0.20$, $0.25$\n              \\item Volatility ($\\sigma$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n          \\end{itemize}\n    \\item Heston Model:\\begin{itemize}\n              \\item $\\kappa$: $0$, $0.05$, ... , $0.45$, $0.50$\n              \\item Initial Volatility ($\\sigma = \\sqrt{\\theta} = \\sqrt{V_0}$): $0.05$, $0.10$, ... , $0.45$, $0.50$\n              \\item $\\rho$: $-1.0$, $-0.95$, ... , $0.95$, $1.0$\n          \\end{itemize}\n    \\item Artificial Market Simulations' parameters: \\begin{itemize}\n              \\item $N_{\\mathrm{agent\/step}}$: $1$, $5$, $10$\n              \\item $w_F, w_C$: $0.0, 1.0, 3.0, 5.0, 10.0, 30.0, 50.0$\n              \\item $\\sigma^{*}$: $10^{-2}$, $10^{-3}$, $10^{-4}$\n              \\item $\\sigma$: $10^{-2}$, $10^{-3}$, $10^{-4}$, $10^{-5}$\n              \\item $\\tau^{*}_{\\mathrm{min}}, \\tau^{*}_{\\mathrm{max}}$: $1$, $10$, ..., $10^{5}$\n              \\item $\\tau_{\\mathrm{min}}, \\tau_{\\mathrm{max}}$: $1$, $10$, ..., $10^{3}$\n              \\item $k_{\\mathrm{min}}, k_{\\mathrm{max}}$: $0.0$, $0.05$, ..., $0.20$\n          \\end{itemize}\n\\end{itemize}\nNote that the parameters with a large or small relationship are considered the constraints of tuning.\nThose parameter candidates are set based on previous studies.\nFor the Brownian motion and Heston models, we set the default parameters based on a previous study \\cite{deep-hedging} and calculated the performance without tuning.\nThe default parameters used in the previous study were $\\mu=0.0, \\sigma=0.2, \\kappa=1.0, \\rho = -0.7$.\n\n\\begin{table*}[htb]\n    \\caption{Option pricing results in each setting}\n    \\label{tab:results}\n    \\centering\n    \\begin{tabular}{ccc|cc|ccc}\n        \\hline\n        \\multicolumn{3}{c|}{Settings} & \\multicolumn{2}{c|}{Default} & \\multicolumn{3}{c}{After Tuning}                                                                                                                        \\\\\n        Derivative                    & Underlying Asset Data        & Utility Function                 & Brownian            & Heston              & Artificial Market Simulation & Brownian            & Heston              \\\\\\hline\n        european                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.019750            & \\color{red}0.019192 & 0.019419                     & 0.019551            & 0.019299            \\\\\n        european                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.020935            & \\color{red}0.020246 & 0.020845                     & 0.036039            & 0.020426            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.050233            & 0.052363            & \\color{red}0.049532          & 0.061715            & 0.050061            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.061153            & 0.061949            & \\color{red}0.058047          & 0.063598            & 0.060551            \\\\\n        european                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.093186            & 0.095895            & 0.113233                     & \\color{red}0.092216 & 0.092759            \\\\\\hline\n        european                      & BVSP                         & ERM ($\\lambda=1$)                & 0.027719            & 0.027331            & \\color{red}0.026537          & 0.027477            & 0.027362            \\\\\n        european                      & BVSP                         & ERM ($\\lambda=10$)               & 0.031842            & \\color{red}0.031358 & 0.032121                     & 0.067403            & 0.031519            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.067626            & 0.070673            & \\color{red}0.064339          & 0.085204            & 0.068147            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.079984            & 0.081648            & \\color{red}0.076255          & 0.084457            & 0.080254            \\\\\n        european                      & BVSP                         & CVaR ($\\alpha=0.99$)             & \\color{red}0.123999 & 0.131008            & 0.147125                     & 0.124240            & 0.126957            \\\\\\hline\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=1$)                & 0.027260            & 0.028259            & \\color{red}0.027046          & 0.027102            & 0.027245            \\\\\n        lookback                      & S\\&P 500                     & ERM ($\\lambda=10$)               & 0.032112            & \\color{red}0.030554 & 0.038140                     & 0.035739            & 0.030621            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.90$)             & 0.085309            & 0.086851            & 0.091485                     & \\color{red}0.076732 & 0.082135            \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.95$)             & 0.105119            & 0.107009            & 0.111806                     & 0.104828            & \\color{red}0.095170 \\\\\n        lookback                      & S\\&P 500                     & CVaR ($\\alpha=0.99$)             & 0.163010            & 0.168566            & 0.164313                     & \\color{red}0.161206 & 0.161686            \\\\\\hline\n        lookback                      & BVSP                         & ERM ($\\lambda=1$)                & 0.045672            & 0.047888            & \\color{red}0.045210          & 0.045743            & 0.046029            \\\\\n        lookback                      & BVSP                         & ERM ($\\lambda=10$)               & 0.051926            & 0.051787            & 0.055111                     & 0.053248            & \\color{red}0.051522 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.90$)             & 0.109817            & 0.106158            & 0.111802                     & \\color{red}0.097037 & 0.102013            \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.95$)             & 0.130552            & 0.125846            & 0.131436                     & 0.122045            & \\color{red}0.115475 \\\\\n        lookback                      & BVSP                         & CVaR ($\\alpha=0.99$)             & 0.200004            & 0.20705             & 0.199006                     & 0.198911            & \\color{red}0.198437 \\\\\\hline\n    \\end{tabular}\n\\end{table*}\n\n\\section{Results and Discussion}\nTable \\ref{tab:results} presents the results of the options pricing experiments for each setting.\nIn this figure, the lower the value, the better the performance.\nThe red values indicate the best performance in each setting.\nThe results show that the proposed approach, using artificial market simulations for underlying asset simulations, can achieve almost the same performance as the traditional approach using mathematical finance models.\nIn particular, the proposed approach can perform best in certain settings, such as the European option with CVaR ($\\alpha=0.90$) and CVaR ($\\alpha=0.95$).\nIn addition, for options with ERM ($\\lambda=1$), the proposed approach can achieve the best performance in most settings.\n\nAdditionally, a comparison of the default parameter results with the results after tuning can sometimes reveal that the default parameters achieve the best performance.\nIt seems that the parameter tuning was carried out using the pricing over S\\&P 500 (old) data, and the parameters are sometimes only suitable for other data.\nHowever, the default parameters are set based on the previous study and could be suitable for the recent data.\n\nMoreover, the results of artificial market simulations are not always the best and are sometimes worse than those of the traditional approach, especially when we employ ERM ($\\lambda=10$) or CVaR ($\\alpha=0.99$) as the utility function.\nThis is because artificial market simulations involve tail-risk events that occur more frequently than the traditional approach.\nThe situations of ERM ($\\lambda=10$) and CVaR ($\\alpha=0.99$) are very risk-sensitive, and tail risk events have a significant impact on the performance.\nTherefore, through the tuning process, artificial market simulations occur more frequently, causing tail-risk events in which the deep hedging model is exposed to greater risk.\nHowever, those very severe risk events occasionally occur in actual markets.\nTherefore, the final results depend heavily on whether such severe risk events occur in actual markets.\nTo investigate more deeply, we plot the distribution of returns in figure \\ref{fig:returns}.\nAccording to figure\\ref{fig:returns}, the distribution of returns for the artificial market has an exceptionally long tail compared to other models (Note that the x-axis range is far different from the others).\nThe S\\&P 500 also has a tail in its distribution; however, the tails are not as long as those of the artificial market simulations.\nHowever, a high-risk environment may yield better results in learning deep hedging; nevertheless, the details should be investigated in future studies.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\\\\\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_return_tail.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_return_tail.pdf}\\\\\n    S\\&P500 (absolute) \\hspace{0.09\\linewidth} Artificial Market Simulation (absolute) \\hspace{0.09\\linewidth} Heston (absolute)\\\\\n    \\caption{Distribution of normalized returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. Orange indicates a Gaussian distribution. The distribution for the artificial market is based on the case of CVaR ($\\alpha=0.95$) for the European Option.}\n    \\label{fig:returns}\n\\end{figure*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the artificial market simulations}\n    \\label{tab:tuning-results-sim}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-1}$                             & $10^{-5}$                           & $10^{-2}$                & $10^{-2}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-5}$     & $10^{-1}$     & $10^{-3}$     \\\\\n        $N_{\\mathrm{agent\/step}}$         & $1$                                   & $10$                                & $1$                      & $10$                     & $10$          & $10$        & $5$          & $5$           & $10$          & $5$           \\\\\n        $w_F$                             & $5.0$                                 & $5.0$                               & $0.0$                    & $50.0$                   & $10.0$        & $0.0$       & $30.0$       & $5.0$         & $1.0$         & $3.0$         \\\\\n        $w_C$                             & $50.0$                                & $50.0$                              & $3.0$                    & $3.0$                    & $1.0$         & $3.0$       & $10.0$       & $1.0$         & $0.0$         & $30.0$        \\\\\n        $\\sigma^{*}$                      & $10^{-3}$                             & $10^{-2}$                           & $10^{-2}$                & $10^{-4}$                & $10^{-4}$     & $10^{-4}$   & $10^{-2}$    & $10^{-4}$     & $10^{-4}$     & $10^{-4}$     \\\\\n        $\\sigma$                          & $10^{-3}$                             & $10^{-2}$                           & $10^{-3}$                & $10^{-4}$                & $10^{-3}$     & $10^{-3}$   & $10^{-3}$    & $10^{-3}$     & $10^{-2}$     & $10^{-2}$     \\\\\n        $\\tau^{*}_{\\mathrm{min}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10$                     & $10$          & $10^5$      & $10^4$       & $10^2$        & $10^4$        & $10^4$        \\\\\n        $\\tau^{*}_{\\mathrm{max}}$         & $10^4$                                & $10^5$                              & $10^4$                   & $10^5$                   & $10^2$        & $10^5$      & $10^5$       & $10^3$        & $10^5$        & $10^5$        \\\\\n        $\\tau_{\\mathrm{min}}$             & $10^2$                                & $10^2$                              & $1$                      & $10^2$                   & $1$           & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $\\tau_{\\mathrm{max}}$             & $10^3$                                & $10^2$                              & $1$                      & $10^2$                   & $10$          & $1$         & $10$         & $10$          & $10$          & $10^2$        \\\\\n        $k_{\\mathrm{min}}$                & $0.05$                                & $0.10$                              & $0.0$                    & $0.15$                   & $0.15$        & $0.15$      & $0.20$       & $0.20$        & $0.10$        & $0.10$        \\\\\n        $k_{\\mathrm{max}}$                & $0.10$                                & $0.15$                              & $0.20$                   & $0.20$                   & $0.15$        & $0.20$      & $0.20$       & $0.20$        & $0.15$        & $0.20$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using Brownian motion}\n    \\label{tab:tuning-results-brownian}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-3}$                             & $10^{-3}$                           & $10^{-4}$                & $10^{-3}$                & $10^{-5}$     & $10^{-5}$   & $10^{-1}$    & $10^{-4}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\mu$                             & $0.00$                                & $-0.05$                             & $-0.05$                  & $-0.10$                  & $-0.05$       & $0.0$       & $-0.05$      & $0.0$         & $-0.05$       & $0.05$        \\\\\n        $\\sigma$                          & $0.15$                                & $0.20$                              & $0.25$                   & $0.50$                   & $0.50$        & $0.15$      & $0.05$       & $0.35$        & $0.05$        & $0.35$        \\\\\n    \\end{tabular}\n\\end{table*}\n\\begin{table*}[htb]\n    \\caption{Parameters of the best-performing models in each setting using the Heston model}\n    \\label{tab:tuning-results-heston}\n    \\centering\n    \\begin{tabular}{c||c|c|c|c|c||c|c|c|c|c}\n        \\hline\n        Derivative                        & \\multicolumn{5}{c||}{European Option} & \\multicolumn{5}{c}{Lookback Option}                                                                                                                                                    \\\\\\hline\n        \\multirow{2}{*}{Utility Function} & \\multicolumn{2}{c|}{ERM}              & \\multicolumn{3}{c||}{CVaR}          & \\multicolumn{2}{c|}{ERM} & \\multicolumn{3}{c}{CVaR}                                                                                              \\\\\n                                          & $\\lambda=1$                           & $\\lambda=10$                        & $\\alpha=0.90$            & $\\alpha=0.95$            & $\\alpha=0.99$ & $\\lambda=1$ & $\\lambda=10$ & $\\alpha=0.90$ & $\\alpha=0.95$ & $\\alpha=0.99$ \\\\\\hline\\hline\n        Learning rate                     & $10^{-4}$                             & $10^{-3}$                           & $10^{-5}$                & $10^{-4}$                & $10^{-5}$     & $10^{-2}$   & $10^{-5}$    & $10^{-1}$     & $10^{-2}$     & $10^{-3}$     \\\\\n        $\\sigma$                          & $0.35$                                & $0.45$                              & $0.30$                   & $0.40$                   & $0.30$        & $0.05$      & $0.25$       & $0.15$        & $0.10$        & $0.15$        \\\\\n        $\\kappa$                          & $0.30$                                & $0.40$                              & $0.45$                   & $0.05$                   & $0.05$        & $0.40$      & $0.20$       & $0.45$        & $0.15$        & $0.20$        \\\\\n        $\\rho$                            & $1.00$                                & $0.05$                              & $-0.95$                  & $-1.00$                  & $0.30$        & $0.30$      & $-0.35$      & $-0.35$       & $-0.95$       & $0.30$        \\\\\n    \\end{tabular}\n\\end{table*}\n\nIn Tables \\ref{tab:tuning-results-sim}, \\ref{tab:tuning-results-brownian}, and \\ref{tab:tuning-results-heston}, we show the parameters of the best-performing models in each setting using artificial market simulations, Brownian motion, and Heston model, respectively.\nAccording to the results, the parameters of the best-performing models differed for each setting.\nThere are two possible reasons for this.\nFirst, the parameters were not fully optimized during the tuning process.\nHowever, even in the case of Brownian motion, the parameters are not always the same in each setting, even though the number of parameters is extremely small.\nTherefore, this is insufficient to explain this difference.\nSecond, the optimal parameters depend strongly on the situation.\nThe utility function is particularly vital for deep hedging and risk awareness.\nTherefore, for risk-sensitive utility functions such as CVaR ($\\alpha=0.99$), high-risk situations such as volatile markets are preferred for deep hedging training.\nOn the contrary, for risk-insensitive utility functions such as ERM ($\\lambda=1$), stable markets are preferred.\nTherefore, the best parameters depend highly on the situation and the utility function.\nThis finding is supported by a previous study \\cite{Hirano2023-icaif}.\nThus, the best situation for deep hedging is highly dependent on the utility function, and the tuning process is important for achieving the best performance under each setting.\n\n\\begin{figure*}[htb]\n    \\centering\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sp500_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/sim_kurt.pdf}\n    \\includegraphics[width=0.32\\linewidth]{.\/figs\/heston_kurt.pdf}\\\\\n    S\\&P500 \\hspace{0.17\\linewidth} Artificial Market Simulation \\hspace{0.17\\linewidth} Heston\n    \\caption{Kutosis of returns. From left to right, S\\&P 500, Artificial Markets, and Heston plotted in 0.5 intervals. The horizontal axis is the lag used for the return calculation.}\n    \\label{fig:kurt}\n\\end{figure*}\n\nIn our proposed method, the artificial market simulation we employ is very simple but outperforms in some settings.\nOne possible reason for this is that the artificial market simulation can replicate some important features of the actual market that cannot be replicated by other mathematical finance models.\nFor example, the tail properties of the returns shown in figure \\ref{fig:returns} are an example of stylized facts; however, this is also replicated in the Heston model.\nHowever, in terms of kurtosis, that is, the other indices of tail properties, the artificial market simulation replicates better than the Heston model, as shown in figure \\ref{fig:kurt}.\nIn the figure \\ref{fig:kurt}, the kurtosis of the Heston model is almost 3, which means that the tails of the returns are almost the same as those in the normal distribution.\nHowever, the artificial market simulation is far higher than 3.0 when the lag used for the return calculation is small.\nEven though the maximum kurtosis of the S\\&P 500 in the figure is approximately 13, it seemingly better replicates the kurtosis of the actual market data than the Heston model.\nMoreover, another stylized fact can be observed in the figure \\ref{fig:kurt}.\nAccording to \\cite{Cont2001}, aggregational gaussianity is one of the stylized facts of the actual market data.\nAggregational Gaussianity implies that the distribution of the returns becomes more Gaussian as the time scale increases.\nAccording to figure \\ref{fig:kurt}, the rate at which the kurtosis of the artificial market simulation decreases is similar to that of the actual market data.\nAccording to these results, artificial market simulation can replicate the stylized facts of actual market data better than the Heston model, and artificial market simulation is a good candidate for comprehending the underlying asset simulation in deep hedging.\n\nThis study had some limitations.\nFirst, the artificial market simulation employed in this study is simple and insufficient to replicate actual market data.\nTherefore, in the future, we need to develop more sophisticated artificial market simulations for deep hedging and imitate actual market data.\nSecond, the reason why artificial market simulations outperform in some settings is not fully understood.\nAdditional investigations are needed to reveal the underlying asset simulation for deep hedging.\nThird, the situation that the bias between the training and test data is smaller than in the current setting should be tested.\nIn this study, the training data are S\\&P 500 (old), and the test data are S\\&P 500 and BVSP. There is a 50-year difference between the training and test data.\nThus, if we employ rolling training periods, which are very close to the test data period, the performance could be improved.\n\n\\section{Conclusion}\nThis study proposes a new approach using artificial market simulations for underlying asset simulations in deep hedging.\nUnlike previous studies, we utilize fully artificial market simulations for underlying asset simulations.\nTo investigate the effectiveness of the proposed approach, we conducted experiments on option pricing using an actual market simulator and a traditional approach using mathematical finance models.\nIn the experiments, we tuned certain hyperparameters and compared the results of the proposed approach with those of the traditional approach.\nThe results show that the proposed approach can achieve almost the same performance as the traditional approach, and, under some settings, the proposed approach can achieve the best performance.\nMoreover, we found that the best parameters of the proposed approach were highly dependent on the situation and utility function.\nThese results show that the artificial market simulation is a good candidate for the underlying asset simulation in deep hedging; however, it still has some limitations.\nFuture studies should develop more sophisticated artificial market simulations and investigate the robust underlying asset simulations for deep hedging.\n\n\n\\bibliographystyle{IEEEtran}\n\\bibliography{cite}\n\n\\end{document}\n","rating_answer":"1. Originality: 9\n2. Method: 8\n3. Credibility: 8\n4. Understandability: 9\n5. Relevance: 9\n6. Quality of Citations: 8\n7. Linguistic style and soundness of grammar: 9\n8. Overall score: 8.5"}
